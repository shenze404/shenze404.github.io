<script>
    async function register() {
        var id = document.getElementById("id").value.trim();
        var avatar = document.getElementById("avatar").files[0];
        var password = document.getElementById("password").value.trim();

        if (id === "" || password === "") {
            alert("ID 和密钥不能为空！");
            return;
        }

        if (!/^\d{4}$/.test(password)) {
            alert("密钥必须是 4 位数字！");
            return;
        }

        var reader = new FileReader();
        reader.onload = async function(event) {
            var avatarURL = event.target.result;

            let response = await fetch('https://raw.githubusercontent.com/你的用户名/你的仓库/main/users.json');
            let users = await response.json();

            if (users.some(user => user.id === id)) {
                alert("此 ID 已被注册，请使用其他 ID！");
                return;
            }

            users.push({ id: id, avatar: avatarURL, password: password });

            await updateGitHub(users);

            // 设置跳转目标为登录页面
            localStorage.setItem("statusMessage", "注册成功！");
            localStorage.setItem("redirectTarget", "login.html");
            localStorage.setItem("redirectDelay", 2000);

            // 跳转到状态页面
            window.location.href = "status.html";
        };
        reader.readAsDataURL(avatar);
    }
</script><script>
    async function register() {
        var id = document.getElementById("id").value.trim();
        var avatar = document.getElementById("avatar").files[0];
        var password = document.getElementById("password").value.trim();

        if (id === "" || password === "") {
            alert("ID 和密钥不能为空！");
            return;
        }

        if (!/^\d{4}$/.test(password)) {
            alert("密钥必须是 4 位数字！");
            return;
        }

        var reader = new FileReader();
        reader.onload = async function(event) {
            var avatarURL = event.target.result;

            let response = await fetch('https://raw.githubusercontent.com/你的用户名/你的仓库/main/users.json');
            let users = await response.json();

            if (users.some(user => user.id === id)) {
                alert("此 ID 已被注册，请使用其他 ID！");
                return;
            }

            users.push({ id: id, avatar: avatarURL, password: password });

            await updateGitHub(users);

            // 设置跳转目标为登录页面
            localStorage.setItem("statusMessage", "注册成功！");
            localStorage.setItem("redirectTarget", "login.html");
            localStorage.setItem("redirectDelay", 2000);

            // 跳转到状态页面
            window.location.href = "status.html";
        };
        reader.readAsDataURL(avatar);
    }
</script>
